---
title: Architecture Overview
description: "Entry point for paiOS architecture documentation: architectural decisions, domain documentation, and cross-cutting concerns."
---

import { Aside } from '@astrojs/starlight/components';

## Architecture Documentation

paiOS architecture documentation falls into three categories:

### ğŸ“ Architecture Views

High-level visualizations of the system from different perspectives:

- **[C4 Architecture](/architecture/c4-architecture/)**: System Context, Container, and Component diagrams (C4 model)
- **[OS and Infrastructure](/architecture/operating-system/)**: OS, Hardware, and Deployment context

### ğŸ§© Engine Domains

Detailed documentation for each domain crate, covering ports, adapters, feature flags, and data flow:

- **[Domains Overview](/architecture/modules/)**: Index of all domain crates
- **[Common](/architecture/modules/common/)**: Shared foundation (logging, config, permissions)
- **[Core](/architecture/modules/core/)**: Orchestrator, SessionManager, FlowRunner
- **[Inference](/architecture/modules/inference/)**: AI backends, resource management, MCP client
- **[Audio](/architecture/modules/audio/)**: Audio capture, playback, signal conditioning
- **[Vision](/architecture/modules/vision/)**: Camera, frame processing, motion gating
- **[API](/architecture/modules/api/)**: API Gateway, protocol adapters, routing
- **[Peripherals](/architecture/modules/peripherals/)**: HMI, buttons, LEDs, haptics

### ğŸ”§ Cross-Cutting Concerns

Topics that span multiple domains:

- **[Workspace and Build](/architecture/workspace-and-build/)**: Feature flags, sys-crate pattern, default profiles, build configuration, and [platform support](/architecture/workspace-and-build/#platform-support) (multi-platform engine, Linux desktop for development, contributor welcome for other OS)
- **[Composition Root (main.rs)](/architecture/composition-root/)**: The only place that knows which adapters exist; bootstrap, init, and dependency injection
- **[Security Architecture](/architecture/security/)**: Permission system, port isolation, [HITL](/glossary/#h) workflow

### ğŸ“‹ Architecture Decision Records (ADRs)

ADRs document the **"why"** behind key decisions. They capture context, alternatives considered, and consequences; not implementation details:

- **[ADR Index](/architecture/adr/)**: All Architecture Decision Records
- **[ADR-004: Engine Architecture](/architecture/adr/004-system-architecture/)**: Core Engine architectural decisions (Hexagonal Architecture, Modular Monolith, Hybrid Inference)

## Hexagonal Architecture

paiOS uses **Hexagonal Architecture** (Ports and Adapters). Rust traits map to Ports; feature-gated structs map to Adapters. Dependencies point inward; `pai-engine/src/main.rs` is the Composition Root.

**Vendor Flexibility and Rapid Porting:** While the Rockchip RK3588 is the initial deployment target, this architecture ensures the engine is completely **vendor-agnostic**. Hardware-specific SDKs are isolated in adapters, meaning the system can be rapidly ported to new SoCs (e.g., from NVIDIA, Qualcomm, or Apple) without rewriting any core business logic.

**paiEngine is a flexible platform:** The engine provides multiple APIs. **gRPC over Unix Domain Sockets (UDS) is the primary IPC interface** for applications/services running on the **same hardware**: comparable to Linux syscalls. For communicating with **external clients on other machines**, the engine provides **gRPC over TCP/TLS**. REST (Ollama/OpenAI compatibility) and MCP are also supported for specific use cases. For mobile/wearable form factors, a smartphone companion app can serve as a user interface for configuration and interaction; the engine itself is designed to be extended for any [AI device](/glossary/#a).

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  Driving           â”‚         Domain              â”‚         Driven
  Adapters â”€â”€â”€â”€â”€â”€â–º  â”‚  (Ports = Rust Traits)      â”‚  â”€â”€â”€â”€â”€â”€â–º Adapters
  (API, HMI)        â”‚  (Pure business logic)      â”‚  (Camera, NPU, Mic)
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Code Layout

**Package by Feature:** Each domain crate contains its own domain logic, ports (traits), and feature-gated adapters. See [Workspace and Build](/architecture/workspace-and-build/) for the full workspace structure.

## ADRs vs. Module Documentation

| Documentation Type | Purpose | Example |
|-------------------|---------|---------|
| **ADRs** | Document **decisions** and their rationale | "Why Hexagonal Architecture?" |
| **Module docs** | Document **current state** implementation | "How `inference` manages resources" |
| **Cross-cutting docs** | Document **shared concerns** across modules | "Feature flag conventions" |
