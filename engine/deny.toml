# cargo-deny configuration for PAI Engine
# Enforces strict AGPL-3.0 license compatibility
# See: https://github.com/embarkstudios/cargo-deny

[graph]
# Target platforms for PAI OS (ARM64 for Radxa Rock 5C, plus development targets)
targets = [
    "aarch64-unknown-linux-gnu",  # Primary target: Radxa Rock 5C
    "x86_64-unknown-linux-gnu",    # Development target
    "x86_64-unknown-linux-musl",   # Alternative Linux target
]
all-features = true

[advisories]
# Check for security advisories
unmaintained = "warn"
yanked = "deny"
vulnerability = "deny"
notice = "warn"

[bans]
# Prevent multiple versions of the same crate
multiple-versions = "deny"
# Prevent wildcard dependencies
wildcards = "deny"
# Deny specific problematic crates
deny = []

[sources]
# Only allow crates from known registries
unknown-registry = "deny"
unknown-git = "deny"
# Allow crates.io (default registry)
allow-registry = ["https://github.com/rust-lang/crates.io-index"]

[licenses]
# High confidence threshold for license detection
confidence-threshold = 0.93
# Unused allowed licenses should be warned about
unused-allowed-license = "warn"
# Note: We explicitly allow AGPL-3.0 and compatible copyleft licenses in the allow list below
# Other copyleft licenses (like GPL-2.0) are implicitly denied

# Licenses compatible with AGPL-3.0
# AGPL-3.0 is a strong copyleft license, but these permissive licenses
# can be used in AGPL-3.0 projects
allow = [
    # Permissive licenses (compatible with AGPL-3.0)
    "MIT",
    "Apache-2.0",
    "Apache-2.0 WITH LLVM-exception",
    "BSD-2-Clause",
    "BSD-3-Clause",
    "ISC",
    "Zlib",
    "Unicode-DFS-2016",
    "Unicode-3.0",
    # AGPL-3.0 itself (our project license)
    # Note: cargo-deny uses bare GNU license IDs without -only/-or-later suffixes
    "AGPL-3.0",
    # GPL-3.0+ is compatible with AGPL-3.0
    "GPL-3.0",
    # LGPL-3.0+ is compatible
    "LGPL-3.0",
    # MPL-2.0 is compatible (weak copyleft)
    "MPL-2.0",
]

# Exceptions for specific crates (if needed)
# Format: { allow = ["LICENSE"], crate = "crate-name", version = "VERSION" }
exceptions = []

